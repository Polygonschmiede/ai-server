#!/usr/bin/env bash
# AI GOAT - Wrapper script to activate venv and run Python app

# Resolve symlinks to get the real script location
SCRIPT_PATH="${BASH_SOURCE[0]}"
while [ -L "$SCRIPT_PATH" ]; do
    SCRIPT_DIR="$(cd "$(dirname "$SCRIPT_PATH")" && pwd)"
    SCRIPT_PATH="$(readlink "$SCRIPT_PATH")"
    [[ $SCRIPT_PATH != /* ]] && SCRIPT_PATH="$SCRIPT_DIR/$SCRIPT_PATH"
done
SCRIPT_DIR="$(cd "$(dirname "$SCRIPT_PATH")" && pwd)"

# Check if venv exists
if [ ! -d "${SCRIPT_DIR}/venv" ]; then
    echo "Virtual environment not found. Please run install-cli.sh first."
    echo "  cd ${SCRIPT_DIR} && bash install-cli.sh"
    echo ""
    echo "Script directory: ${SCRIPT_DIR}"
    exit 1
fi

# Activate venv and run Python app
source "${SCRIPT_DIR}/venv/bin/activate"
python3 "${SCRIPT_DIR}/ai-goat.py" "$@"
